<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Alert</title>

<style>
  body {
    margin: 0;
    background: transparent;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }

  #box {
    display: none;
    align-items: center;
    gap: 16px;
    padding: 18px 26px;
    background: rgba(0,0,0,0.8);
    border-radius: 16px;
  }

  #box img {
    width: 90px;
  }

  #text {
    color: #00ff66;
    font-size: 28px;
    font-weight: bold;
    white-space: nowrap;
  }
</style>
</head>

<body>

<div id="box">
  <img src="Coffee.gif">
  <div id="text"></div>
</div>

<audio id="sound" src="anya.mp3"></audio>

<script>
let last = "";

async function poll() {
  try {
    const r = await fetch("http://localhost:8000/latest");
    const d = await r.json();

    if (!d || !d.name || !d.amount) return;

    const key = d.name + d.amount;
    if (key === last) return;
    last = key;

    show(d);
  } catch(e){}
}

function show(d) {
  const box = document.getElementById("box");
  const text = document.getElementById("text");
  const sound = document.getElementById("sound");

  text.innerText = `${d.name} just tipped â‚¹${d.amount}`;
  box.style.display = "flex";

  sound.currentTime = 0;
  sound.play();

  setTimeout(() => {
    box.style.display = "none";
  }, 5000);
}

setInterval(poll, 2000);
</script>

</body>
</html>
